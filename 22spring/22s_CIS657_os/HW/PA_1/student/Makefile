# ==============================
# DO NOT EDIT THIS FILE
# Created by: Endadul Hoque 
# ==============================
# This Makefile is used easily clean each 
# sub-directories and create the compressed tarball
# for submission.
# ==================================================
#
.PHONY: all distclean submit clean

PA := pa1
SUBDIRS := task-1

all:
	$(error does nothing! valid command is 'make distclean' or 'make submit')

distclean: clean
	for dir in $(SUBDIRS); do \
	  $(MAKE) -C $$dir clean; \
	done


#================= For submission =======
#========================================
USERNAME := $(shell echo $${USER})
PKG_DIR := $(USERNAME)-$(PA)
CPKG := $(PKG_DIR).tar.gz

clean:
	@rm -rf $(CPKG) $(PKG_DIR)

submit: 
ifeq (, $(USERNAME))
  	$(error Failed to resolve your username. Please contact TA.)

else
	@echo 'Preparing submission for $(USERNAME)'
	@rm -rf $(CPKG) $(PKG_DIR)
	@echo 'Creating a new directory $(PKG_DIR)' && mkdir $(PKG_DIR)  && \
	  find task-* -type f -name "tinyshell.c" | xargs -n1 -I{} -t cp --parents '{}' $(PKG_DIR)/ && \
	  echo 'Creating archive $(CPKG)' && \
	  tar czf $(CPKG) $(PKG_DIR) && \
	  printf "\nYour submission is ready to submit. To verify its content, try this 'tar tvzf $(CPKG)'.\n" && \
	  printf "\n***Please upload $(CPKG) to Blackboard***\n\n"
endif

